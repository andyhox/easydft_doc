# 20. Band-Center 后处理

在催化材料设计与电子结构研究中，能带中心（d-band center）是预测材料表面吸附能力与反应活性的关键参数。它决定了活性位点与反应物之间的电子转移效率，直接影响催化性能（如析氢、CO₂还原等）。

刚刚开始学习vasp的时候，求band center还是在origin里面先做图然后进行积分，再后处理得到具体数值。

后面有了vaspkit，各种后处理直接一键搞定。对于所有从事VASP计算的人来说，vaspkit yyds。

不过，老司机这个系列都是在分享如何用`pymatgen`​库来进行数据前后处理，今天分享一下怎么用`pymatgen`​代码来处理得到band center的数值。

这里老司机是在`jobflow-remote`​工作流的基础上直接处理数据。完整代码如下：

```python
from easydft.workflow.jfremote import querydata
from pymatgen.electronic_structure.core import OrbitalType, Spin
from pymatgen.electronic_structure.plotter import DosPlotter

store = querydata(jf_project='test')
dos = store.query_dos(criteria={"name":"nonscf","output.flow_name":"test"})
dosplotter = DosPlotter(sigma=0.05)
dosplotter.add_dos(label='La_d', dos=dos.get_element_spd_dos(el='La')[OrbitalType.d])
dosplotter.get_plot()
d_band_center = dos.get_band_center(band=OrbitalType.d, elements=['La'])
print(s_band_center)
```

逐行分析代码：

```python
store = querydata(jf_project='test')
dos = store.query_dos(criteria={"name":"nonscf","output.flow_name":"test"})
```

由于老司机这里直接从工作流的文档中读取结果，所以跟平常的方法不一样，如果个人使用只针对态密度的计算进行后处理，只需要读取`vasprun.xml`​文件即可，上述代码可修改成：

```python
from pymatgen.io.vasp.outputs import Vasprun

vasprun = Vasprun('/path/dos/vasprun.xml')
# 从vasprun.xml中读取dos
dos = vasprun.complete_dos
```

如果想同时绘制态密度图，可参考态密度绘制，如果只分析结构，可直接看最后两行代码：

```python
d_band_center = dos.get_band_center(band=OrbitalType.d, elements=['La'])
print(d_band_center)
```

​`dos`​对象可直接调用`get_band_center()`​方法：

- band：分析的轨道，默认为d轨道；
- elements：分析的元素；
- sites：分析的位点；
- spin：自旋方向，默认为上下自旋结合考虑；
- erange：能量范围，默认为所有能量范围；

注：`elements`​和`sites`​不能同时使用，即要么通过元素符合来定位要分析的原子，要么通过site编号来定位要分析的原子。
